(self.webpackChunkaem_maven_archetype=self.webpackChunkaem_maven_archetype||[]).push([[567],{"./src/main/webpack/components/location-map-results/location-map-results.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return LocationMapResults}});__webpack_require__("./node_modules/core-js/modules/es.string.trim.js"),__webpack_require__("./node_modules/core-js/modules/es.promise.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.string.link.js"),__webpack_require__("./node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("./node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("./node_modules/core-js/modules/es.object.entries.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.array.push.js"),__webpack_require__("./node_modules/core-js/modules/es.error.cause.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.test.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var LocationMapResults=function(){function LocationMapResults(el){var _el$dataset,_el$dataset2,_el$dataset3;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LocationMapResults),this.el=el,el&&(this.markerImg="/etc.clientlibs/efe/clientlibs/clientlib-site/resources/images/icons/efe-marker.svg",this.searchBtn=el.querySelector(".search-location-btn"),this.searchInput=el.querySelector("#location"),this.handleLocationSearch=this.searchBtn.addEventListener("click",this.handleLocationSearch.bind(this)),this.handleLocationEnter=this.searchInput.addEventListener("keyup",this.handleLocationEnter.bind(this)),this.offices=JSON.parse(null===(_el$dataset=el.dataset)||void 0===_el$dataset?void 0:_el$dataset.offices),this.EXPLORE_LINK_LABEL=null===(_el$dataset2=el.dataset)||void 0===_el$dataset2?void 0:_el$dataset2.explorelinkLabel,this.PLANNER_BTN_LABEL=null===(_el$dataset3=el.dataset)||void 0===_el$dataset3?void 0:_el$dataset3.plannerBtnLabel,this.defaultLatitude=39.828175,this.defaultLongitude=-98.5795,this.furthestOffice=48280,this.initMap(this.offices,{lat:this.defaultLatitude,lng:this.defaultLongitude,firstLoad:!0}),this.trackFindaPlanner=!1)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(LocationMapResults,[{key:"handleLocationEnter",value:function handleLocationEnter(event){13===event.keyCode&&(event.preventDefault(),this.searchBtn.click())}},{key:"getCurrentSearchedLatAndLng",value:function getCurrentSearchedLatAndLng(){var _this$el$querySelecto,searchInput=null===(_this$el$querySelecto=this.el.querySelector("#location"))||void 0===_this$el$querySelecto?void 0:_this$el$querySelecto.value;this.geocodeAddress(searchInput).then((function(results){return{latitude:results.latitude,longitude:results.longitude}})).catch((function(error){console.error("Geocode failed with error: "+error)}))}},{key:"handleEmptyResults",value:function handleEmptyResults(res){var latitude,longitude;if(res)latitude=res.latitude,longitude=res.longitude;else{var coordinates=this.getCurrentSearchedLatAndLng();latitude=coordinates.latitude,longitude=coordinates.longitude}this.showSearchResultsContainer(null,{showNationalAdvisor:!0,lat:latitude,lng:longitude,hidePin:!0})}},{key:"handleLocationSearch",value:function handleLocationSearch(event){var _this$el$querySelecto2,_this$el$dataset,_this=this;event.preventDefault();var _window$adobeDataLaye2,_window$adobeDataLaye,searchInput=null===(_this$el$querySelecto2=this.el.querySelector("#location"))||void 0===_this$el$querySelecto2?void 0:_this$el$querySelecto2.value;this.trackFindaPlanner?null===(_window$adobeDataLaye2=window.adobeDataLayer)||void 0===_window$adobeDataLaye2||_window$adobeDataLaye2.push({event:"find_planner_click",web:{webInteraction:{name:"Search Location",region:"Body",type:"other",locationValue:searchInput,searchLocation:{value:1},findPlanner:{value:0}}}}):(null===(_window$adobeDataLaye=window.adobeDataLayer)||void 0===_window$adobeDataLaye||_window$adobeDataLaye.push({event:"find_planner_click",web:{webInteraction:{name:"Find a Planner",region:"Body",type:"other",locationValue:searchInput,findPlanner:{value:1}}}}),this.trackFindaPlanner=!0);if(this.searchBtn.textContent=(null===(_this$el$dataset=this.el.dataset)||void 0===_this$el$dataset?void 0:_this$el$dataset.searchBtnLabel)||"Search Destinations",""===searchInput)this.showSearchResultsContainer(null,{showNationalAdvisor:!0,lat:this.defaultLatitude,lng:this.defaultLongitude,hidePin:!0});else{searchInput=searchInput.trim().toLowerCase();var data=this.filterArray(searchInput);0===data.length?this.geocodeAddress(searchInput).then((function(results){var nearbyLocations=_this.getLocationsWithin30MileRadius(results.latitude,results.longitude);0===nearbyLocations.length?_this.handleEmptyResults(results):(_this.furthestOffice=48280/1.8,_this.showSearchResultsContainer(nearbyLocations,{showNationalAdvisor:!1,lat:results.latitude,lng:results.longitude,showBounds:!0}))})).catch((function(error){_this.showSearchResultsContainer(null,{showNationalAdvisor:!0,lat:_this.defaultLatitude,lng:_this.defaultLongitude,hidePin:!0}),console.error("Geocode failed with error: "+error)})):this.geocodeAddress(searchInput).then((function(results){_this.furthestOffice=_this.getDynamicRadiusForFurthestOffice(results.latitude,results.longitude,data),_this.showSearchResultsContainer(data,{showNationalAdvisor:!1,lat:results.latitude,lng:results.longitude,showBounds:!0})})).catch((function(error){console.error("Geocode failed with error: "+error)}))}this.searchInput=searchInput}},{key:"geocodeAddress",value:function geocodeAddress(address){var geocoder=new google.maps.Geocoder,componentRestrictions={country:"US"};return new Promise((function(resolve,reject){geocoder.geocode({address:address,componentRestrictions:componentRestrictions},(function(results,status){if("OK"===status){var latitude=results[0].geometry.location.lat(),longitude=results[0].geometry.location.lng();console.log(latitude,longitude),resolve({latitude:latitude,longitude:longitude})}else console.error("Geocode was not successful for the following reason: "+status),reject(status)}))}))}},{key:"showSearchResultsContainer",value:function showSearchResultsContainer(results,obj){var _this2=this;this.el.classList.remove("cmp-location--results-default"),this.clearCurrentResults(),obj&&obj.showNationalAdvisor?this.constructEmptyResults():results.forEach((function(result){_this2.constructSearchResults(result)})),this.initMap(results,obj)}},{key:"clearCurrentResults",value:function clearCurrentResults(){var resultsContainer=this.el.querySelector(".cmp-location--results__items");resultsContainer.classList.contains("no-results")&&resultsContainer.classList.remove("no-results"),resultsContainer.innerHTML=""}},{key:"constructEmptyResults",value:function constructEmptyResults(){var _this$el$dataset2,_this$el$dataset3,_this$el$dataset4,_this$el$dataset5,_this$el$dataset6;console.log(this);var nationalTitle=null===(_this$el$dataset2=this.el.dataset)||void 0===_this$el$dataset2?void 0:_this$el$dataset2.nationalTitle,nationalDetails=null===(_this$el$dataset3=this.el.dataset)||void 0===_this$el$dataset3?void 0:_this$el$dataset3.nationalDetails,nationalCallback=null===(_this$el$dataset4=this.el.dataset)||void 0===_this$el$dataset4?void 0:_this$el$dataset4.nationalCallback,nationalCallbackLabel=null===(_this$el$dataset5=this.el.dataset)||void 0===_this$el$dataset5?void 0:_this$el$dataset5.nationalCallbackLabel,nationalLink=null===(_this$el$dataset6=this.el.dataset)||void 0===_this$el$dataset6?void 0:_this$el$dataset6.nationalLink,resultsContainer=this.el.querySelector(".cmp-location--results__items");resultsContainer.classList.add("no-results");var item=document.createElement("div");item.classList.add("cmp-location--results__items--item");var h2=document.createElement("h2");h2.textContent=nationalTitle,item.appendChild(h2);var telLink=document.createElement("a");telLink.classList.add("cmp-tel-link"),telLink.href="tel:"+nationalCallback,telLink.innerText=nationalCallbackLabel,item.appendChild(telLink);var link=document.createElement("a");link.href=nationalLink,link.textContent=this.EXPLORE_LINK_LABEL,item.appendChild(link);var p=document.createElement("p");p.textContent=nationalDetails,item.appendChild(p),resultsContainer.appendChild(item)}},{key:"constructSearchResults",value:function constructSearchResults(result){var resultsContainer=this.el.querySelector(".cmp-location--results__items"),item=document.createElement("div");item.classList.add("cmp-location--results__items--item");var title=document.createElement("h2");title.textContent=result.externalName;var street1=document.createElement("p");street1.textContent=result.address1;var street2=document.createElement("p");street2.textContent=result.address2;var locationInfo=document.createElement("p"),city=document.createElement("span");city.textContent=result.city;var state=document.createElement("span");state.textContent=result.state;var zip=document.createElement("span");zip.textContent=result.zip,locationInfo.appendChild(city),locationInfo.appendChild(document.createTextNode(" ")),locationInfo.appendChild(state),locationInfo.appendChild(document.createTextNode(" ")),locationInfo.appendChild(zip);var link=document.createElement("a");link.href=result.link,link.textContent=this.EXPLORE_LINK_LABEL,item.appendChild(title),item.appendChild(street1),item.appendChild(street2),item.appendChild(locationInfo),item.appendChild(link),resultsContainer.appendChild(item)}},{key:"getLocationsWithin30MileRadius",value:function getLocationsWithin30MileRadius(lat,lng){var searchLat=lat,searchLng=lng,nearbyLocations=[];return this.offices.forEach((function(location){var locationLat=parseFloat(location.latitude),locationLng=parseFloat(location.longitude),distance=621371e-9*google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(searchLat,searchLng),new google.maps.LatLng(locationLat,locationLng));distance<=30&&nearbyLocations.push(Object.assign({},location,{distance:distance}))})),nearbyLocations}},{key:"getDynamicRadiusForFurthestOffice",value:function getDynamicRadiusForFurthestOffice(lat,lng,locations){var furthestLocation=0;return locations.forEach((function(location){var locationLat=parseFloat(location.latitude),locationLng=parseFloat(location.longitude),distance=621371e-9*google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(lat,lng),new google.maps.LatLng(locationLat,locationLng));isNaN(distance)||(furthestLocation=Math.max(furthestLocation,distance))})),1609.34*furthestLocation/1.8}},{key:"filterArray",value:function filterArray(value){return this.offices.filter((function(obj){return Object.entries(obj).some((function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],val=_ref2[1];return("state"===key||"stateCode"===key||"zip"===key)&&val.toString().toLowerCase()===value.toLowerCase()}))}))}},{key:"initMap",value:function initMap(data,obj){var _this3=this;if("undefined"!=typeof google&&void 0!==google.maps){var myLatLng=new google.maps.LatLng(obj.lat,obj.lng),styles=[{stylers:[{saturation:-100}]}],styledMap=new google.maps.StyledMapType(styles,{name:"Styled Map"}),options={zoom:5,center:myLatLng,mapTypeId:google.maps.MapTypeId.TERRAIN,mapTypeControl:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.TERRAIN,"map_style"]}},map=new google.maps.Map(document.getElementById("map_canvas"),options);if(map.mapTypes.set("map_style",styledMap),map.setMapTypeId("map_style"),!obj.hidePin&&data&&data.forEach((function(office){new google.maps.Marker({position:new google.maps.LatLng(office.latitude,office.longitude),map:map,icon:_this3.markerImg,title:office.city})})),!obj.firstLoad&&obj.showBounds){var circleOptions={center:myLatLng,fillOpacity:0,strokeOpacity:0,map:map,radius:this.furthestOffice},myCircle=new google.maps.Circle(circleOptions);map.fitBounds(myCircle.getBounds())}this.map=map}else console.error("Google maps API was not initialized. Please ensure that you are loading the scripts required to initialize google maps.")}}],[{key:"init",value:function init(el){return new LocationMapResults(el)}}]),LocationMapResults}()},"./node_modules/core-js/internals/create-html.js":function(module,__unused_webpack_exports,__webpack_require__){var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js"),requireObjectCoercible=__webpack_require__("./node_modules/core-js/internals/require-object-coercible.js"),toString=__webpack_require__("./node_modules/core-js/internals/to-string.js"),quot=/"/g,replace=uncurryThis("".replace);module.exports=function(string,tag,attribute,value){var S=toString(requireObjectCoercible(string)),p1="<"+tag;return""!==attribute&&(p1+=" "+attribute+'="'+replace(toString(value),quot,"&quot;")+'"'),p1+">"+S+"</"+tag+">"}},"./node_modules/core-js/internals/string-html-forced.js":function(module,__unused_webpack_exports,__webpack_require__){var fails=__webpack_require__("./node_modules/core-js/internals/fails.js");module.exports=function(METHOD_NAME){return fails((function(){var test=""[METHOD_NAME]('"');return test!==test.toLowerCase()||test.split('"').length>3}))}},"./node_modules/core-js/modules/es.string.link.js":function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){"use strict";var $=__webpack_require__("./node_modules/core-js/internals/export.js"),createHTML=__webpack_require__("./node_modules/core-js/internals/create-html.js");$({target:"String",proto:!0,forced:__webpack_require__("./node_modules/core-js/internals/string-html-forced.js")("link")},{link:function link(url){return createHTML(this,"a","href",url)}})}}]);